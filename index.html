<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>g1 Brookasil - Portal de Not√≠cias</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* RESET E BASE */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --vermelho-g1: #C4170C;
            --branco: #FFFFFF;
            --cinza-claro: #F5F5F5;
            --cinza-medio: #DDDDDD;
            --cinza-escuro: #777777;
            --texto-escuro: #333333;
            --sombra: rgba(0, 0, 0, 0.1);
            --verde: #2E8B57;
            --azul: #1E90FF;
            --amarelo: #FFD700;
        }

        body {
            font-family: Arial, Helvetica, sans-serif;
            color: var(--texto-escuro);
            background-color: var(--cinza-claro);
            line-height: 1.6;
            padding-top: 120px;
            transition: padding 0.3s;
        }

        /* TIPOGRAFIA */
        h1, h2, h3, h4 {
            font-family: 'Arial Black', Arial, sans-serif;
        }

        h1 {
            font-size: 2.5rem;
            color: var(--texto-escuro);
            margin-bottom: 1rem;
        }

        h2 {
            font-size: 2rem;
            color: var(--texto-escuro);
            margin-bottom: 1rem;
            border-left: 5px solid var(--vermelho-g1);
            padding-left: 15px;
        }

        h3 {
            font-size: 1.5rem;
            color: var(--texto-escuro);
            margin-bottom: 0.75rem;
        }

        h4 {
            font-size: 1.2rem;
            color: var(--vermelho-g1);
            margin-bottom: 0.5rem;
        }

        p {
            margin-bottom: 1rem;
        }

        a {
            color: var(--vermelho-g1);
            text-decoration: none;
        }

        a:hover {
            text-decoration: underline;
        }

        /* HEADER FIXO */
        header {
            background-color: var(--vermelho-g1);
            color: var(--branco);
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            z-index: 1000;
            box-shadow: 0 4px 12px var(--sombra);
        }

        .header-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 15px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            font-family: 'Arial Black', Arial, sans-serif;
            font-size: 2.2rem;
            font-weight: bold;
            cursor: pointer;
        }

        .hora-atual {
            font-size: 1rem;
            background: rgba(0, 0, 0, 0.2);
            padding: 5px 10px;
            border-radius: 4px;
        }

        /* MENU PRINCIPAL */
        nav {
            background-color: var(--branco);
            border-bottom: 1px solid var(--cinza-medio);
            position: fixed;
            top: 80px;
            left: 0;
            width: 100%;
            z-index: 999;
            box-shadow: 0 2px 5px var(--sombra);
        }

        .nav-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }

        .menu-desktop {
            display: flex;
            list-style: none;
            overflow-x: auto;
        }

        .menu-desktop li {
            flex-shrink: 0;
        }

        .menu-desktop a {
            display: block;
            padding: 15px 20px;
            color: var(--texto-escuro);
            font-weight: bold;
            transition: all 0.2s;
            border-bottom: 3px solid transparent;
        }

        .menu-desktop a:hover {
            background-color: var(--cinza-claro);
            border-bottom: 3px solid var(--vermelho-g1);
            text-decoration: none;
        }

        .menu-hamburguer {
            display: none;
            font-size: 1.8rem;
            cursor: pointer;
            padding: 10px;
        }

        .menu-mobile {
            display: none;
            list-style: none;
            background-color: var(--branco);
            border-top: 1px solid var(--cinza-medio);
        }

        .menu-mobile.active {
            display: block;
        }

        .menu-mobile a {
            display: block;
            padding: 15px 20px;
            color: var(--texto-escuro);
            border-bottom: 1px solid var(--cinza-medio);
        }

        /* CONTAINER PRINCIPAL */
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            display: grid;
            grid-template-columns: 1fr 300px;
            gap: 30px;
        }

        /* SIDEBAR */
        .sidebar {
            display: flex;
            flex-direction: column;
            gap: 30px;
        }

        /* SE√á√ïES COMUNS */
        .secao {
            background-color: var(--branco);
            border-radius: 10px;
            box-shadow: 0 3px 10px var(--sombra);
            padding: 25px;
            margin-bottom: 30px;
            transition: transform 0.2s;
        }

        .secao:hover {
            transform: translateY(-3px);
        }

        /* MANCHETE PRINCIPAL */
        .manchete-principal {
            grid-column: 1 / -1;
            position: relative;
            overflow: hidden;
            height: 500px;
            border-radius: 10px;
        }

        .manchete-imagem {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.5s;
        }

        .manchete-conteudo {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            background: linear-gradient(transparent, rgba(0, 0, 0, 0.8));
            color: var(--branco);
            padding: 30px;
        }

        .manchete-conteudo h1 {
            color: var(--branco);
            font-size: 3rem;
            margin-bottom: 10px;
        }

        .manchete-conteudo p {
            font-size: 1.3rem;
            opacity: 0.9;
        }

        /* CARDS DE NOT√çCIA */
        .lista-noticias {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 25px;
            margin-bottom: 30px;
        }

        .card-noticia {
            background-color: var(--branco);
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 3px 10px var(--sombra);
            transition: all 0.3s;
            cursor: pointer;
            display: flex;
            flex-direction: column;
        }

        .card-noticia:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 15px var(--sombra);
        }

        .card-imagem-container {
            height: 200px;
            overflow: hidden;
        }

        .card-imagem {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.5s;
        }

        .card-noticia:hover .card-imagem {
            transform: scale(1.05);
        }

        .card-conteudo {
            padding: 20px;
            flex-grow: 1;
            display: flex;
            flex-direction: column;
        }

        .card-categoria {
            color: var(--vermelho-g1);
            font-weight: bold;
            font-size: 0.9rem;
            margin-bottom: 10px;
            text-transform: uppercase;
        }

        .card-titulo {
            font-size: 1.3rem;
            margin-bottom: 10px;
            flex-grow: 1;
        }

        .card-meta {
            color: var(--cinza-escuro);
            font-size: 0.9rem;
            display: flex;
            justify-content: space-between;
            margin-top: 15px;
            padding-top: 15px;
            border-top: 1px solid var(--cinza-medio);
        }

        /* TAGS */
        .tags-container {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-bottom: 15px;
        }

        .tag {
            background-color: var(--cinza-claro);
            color: var(--texto-escuro);
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 0.8rem;
            cursor: pointer;
            transition: all 0.2s;
        }

        .tag:hover {
            background-color: var(--vermelho-g1);
            color: var(--branco);
        }

        /* BOT√ïES */
        .btn {
            display: inline-block;
            background-color: var(--vermelho-g1);
            color: var(--branco);
            border: none;
            padding: 12px 25px;
            border-radius: 5px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.2s;
            text-align: center;
        }

        .btn:hover {
            background-color: #A31209;
            transform: translateY(-2px);
            text-decoration: none;
        }

        .btn-secondary {
            background-color: var(--cinza-escuro);
        }

        .btn-secondary:hover {
            background-color: #555;
        }

        .btn-success {
            background-color: var(--verde);
        }

        .btn-success:hover {
            background-color: #267349;
        }

        .btn-danger {
            background-color: #DC3545;
        }

        .btn-danger:hover {
            background-color: #C82333;
        }

        .btn-small {
            padding: 8px 15px;
            font-size: 0.9rem;
        }

        /* A√á√ïES DE NOT√çCIA */
        .acoes-noticia {
            display: flex;
            gap: 15px;
            margin: 20px 0;
        }

        .acao-btn {
            background: none;
            border: none;
            cursor: pointer;
            font-size: 1.2rem;
            color: var(--cinza-escuro);
            transition: color 0.2s;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .acao-btn:hover {
            color: var(--vermelho-g1);
        }

        .acao-btn.curtido {
            color: var(--verde);
        }

        .acao-btn.descurtido {
            color: #DC3545;
        }

        .acao-btn.republicado {
            color: var(--azul);
        }

        .acao-btn.favoritado {
            color: var(--amarelo);
        }

        /* COMENT√ÅRIOS */
        .comentarios-container {
            margin-top: 30px;
        }

        .form-comentario {
            margin-bottom: 25px;
        }

        .campo-texto {
            width: 100%;
            padding: 15px;
            border: 1px solid var(--cinza-medio);
            border-radius: 5px;
            font-family: Arial, sans-serif;
            font-size: 1rem;
            resize: vertical;
            min-height: 100px;
            margin-bottom: 10px;
        }

        .lista-comentarios {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .comentario {
            background-color: var(--cinza-claro);
            padding: 20px;
            border-radius: 10px;
            border-left: 4px solid var(--cinza-medio);
        }

        .comentario-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
        }

        .comentario-autor {
            font-weight: bold;
            color: var(--vermelho-g1);
        }

        .comentario-data {
            color: var(--cinza-escuro);
            font-size: 0.9rem;
        }

        .comentario-texto {
            margin-bottom: 10px;
        }

        /* MODAL */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(0, 0, 0, 0.7);
            z-index: 2000;
            display: none;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .modal-overlay.active {
            display: flex;
        }

        .modal {
            background-color: var(--branco);
            border-radius: 10px;
            max-width: 800px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        }

        .modal-header {
            background-color: var(--vermelho-g1);
            color: var(--branco);
            padding: 20px;
            border-radius: 10px 10px 0 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-close {
            background: none;
            border: none;
            color: var(--branco);
            font-size: 1.5rem;
            cursor: pointer;
        }

        .modal-body {
            padding: 30px;
        }

        /* FORMUL√ÅRIOS */
        .campo-form {
            margin-bottom: 20px;
        }

        .campo-form label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
        }

        .campo-form input,
        .campo-form select,
        .campo-form textarea {
            width: 100%;
            padding: 12px;
            border: 1px solid var(--cinza-medio);
            border-radius: 5px;
            font-family: Arial, sans-serif;
            font-size: 1rem;
        }

        /* PERFIL */
        .perfil-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
        }

        .perfil-foto {
            width: 150px;
            height: 150px;
            border-radius: 50%;
            object-fit: cover;
            border: 5px solid var(--vermelho-g1);
            margin-bottom: 20px;
        }

        .perfil-nome {
            font-size: 2rem;
            margin-bottom: 10px;
        }

        .perfil-usuario {
            color: var(--cinza-escuro);
            margin-bottom: 20px;
        }

        .perfil-bio {
            margin-bottom: 30px;
            font-size: 1.1rem;
        }

        /* ESTAT√çSTICAS */
        .estatisticas-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .estatistica-card {
            background: linear-gradient(135deg, var(--vermelho-g1), #E53935);
            color: var(--branco);
            padding: 25px;
            border-radius: 10px;
            text-align: center;
        }

        .estatistica-numero {
            font-size: 3rem;
            font-weight: bold;
            margin-bottom: 10px;
        }

        .estatistica-label {
            font-size: 1.1rem;
            opacity: 0.9;
        }

        /* NOTIFICA√á√ïES */
        .notificacoes-container {
            position: fixed;
            top: 120px;
            right: 20px;
            width: 350px;
            background-color: var(--branco);
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
            z-index: 1001;
            display: none;
        }

        .notificacoes-container.active {
            display: block;
        }

        .notificacoes-header {
            background-color: var(--vermelho-g1);
            color: var(--branco);
            padding: 15px;
            border-radius: 10px 10px 0 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .notificacoes-lista {
            max-height: 400px;
            overflow-y: auto;
        }

        .notificacao {
            padding: 15px;
            border-bottom: 1px solid var(--cinza-medio);
            cursor: pointer;
            transition: background-color 0.2s;
        }

        .notificacao:hover {
            background-color: var(--cinza-claro);
        }

        .notificacao-nao-lida {
            background-color: rgba(196, 23, 12, 0.1);
            border-left: 4px solid var(--vermelho-g1);
        }

        /* LOADING SKELETON */
        .skeleton {
            background: linear-gradient(90deg, var(--cinza-claro) 25%, var(--cinza-medio) 50%, var(--cinza-claro) 75%);
            background-size: 200% 100%;
            animation: loading 1.5s infinite;
            border-radius: 5px;
        }

        @keyframes loading {
            0% { background-position: 200% 0; }
            100% { background-position: -200% 0; }
        }

        /* MENSAGENS */
        .mensagem {
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 20px;
            display: none;
        }

        .mensagem.sucesso {
            background-color: #D4EDDA;
            color: #155724;
            border: 1px solid #C3E6CB;
            display: block;
        }

        .mensagem.erro {
            background-color: #F8D7DA;
            color: #721C24;
            border: 1px solid #F5C6CB;
            display: block;
        }

        /* FOOTER */
        footer {
            background-color: var(--texto-escuro);
            color: var(--branco);
            padding: 40px 20px;
            margin-top: 50px;
        }

        .footer-container {
            max-width: 1200px;
            margin: 0 auto;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 30px;
        }

        .footer-col h3 {
            color: var(--branco);
            margin-bottom: 20px;
        }

        .footer-col ul {
            list-style: none;
        }

        .footer-col li {
            margin-bottom: 10px;
        }

        .footer-col a {
            color: #CCCCCC;
        }

        .copyright {
            text-align: center;
            margin-top: 40px;
            padding-top: 20px;
            border-top: 1px solid #444;
            color: #999;
        }

        /* RESPONSIVIDADE */
        @media (max-width: 1024px) {
            .container {
                grid-template-columns: 1fr;
            }
            
            .sidebar {
                grid-row: 2;
            }
        }

        @media (max-width: 768px) {
            body {
                padding-top: 160px;
            }
            
            .menu-desktop {
                display: none;
            }
            
            .menu-hamburguer {
                display: block;
            }
            
            nav {
                top: 70px;
            }
            
            .header-container {
                flex-direction: column;
                gap: 10px;
            }
            
            .logo {
                font-size: 1.8rem;
            }
            
            .manchete-principal {
                height: 400px;
            }
            
            .manchete-conteudo h1 {
                font-size: 2rem;
            }
            
            .lista-noticias {
                grid-template-columns: 1fr;
            }
            
            .estatisticas-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media (max-width: 480px) {
            .manchete-principal {
                height: 300px;
            }
            
            .manchete-conteudo h1 {
                font-size: 1.5rem;
            }
            
            .estatisticas-grid {
                grid-template-columns: 1fr;
            }
            
            .notificacoes-container {
                width: calc(100% - 40px);
                right: 10px;
            }
        }
    </style>
</head>
<body>
    <!-- HEADER -->
    <header>
        <div class="header-container">
            <div class="logo" onclick="mostrarHome()">g1 Brookasil</div>
            <div class="hora-atual" id="hora-atual"></div>
            <div class="acoes-header">
                <button class="btn btn-small" onclick="mostrarLogin()" id="login-btn">Login</button>
                <button class="btn btn-small" onclick="mostrarPerfil()" id="perfil-btn" style="display:none;">Perfil</button>
                <button class="btn btn-small" onclick="mostrarPainel()" id="painel-btn" style="display:none;">Painel</button>
                <button class="acao-btn" onclick="toggleNotificacoes()" id="notificacao-btn" style="display:none;">
                    <i class="fas fa-bell"></i>
                    <span id="contador-notificacoes" style="display:none;">0</span>
                </button>
            </div>
        </div>
    </header>

    <!-- MENU -->
    <nav>
        <div class="nav-container">
            <div class="menu-hamburguer" onclick="toggleMenuMobile()">
                <i class="fas fa-bars"></i>
            </div>
            <ul class="menu-desktop">
                <li><a href="#" onclick="mostrarHome(); return false;">Home</a></li>
                <li><a href="#" onclick="filtrarPorCategoria('Pol√≠tica'); return false;">Pol√≠tica</a></li>
                <li><a href="#" onclick="filtrarPorCategoria('Pol√≠cia'); return false;">Pol√≠cia</a></li>
                <li><a href="#" onclick="filtrarPorCategoria('Educa√ß√£o'); return false;">Educa√ß√£o</a></li>
                <li><a href="#" onclick="filtrarPorCategoria('Esporte'); return false;">Esporte</a></li>
                <li><a href="#" onclick="filtrarPorCategoria('Entretenimento'); return false;">Entretenimento</a></li>
                <li><a href="#" onclick="filtrarPorCategoria('Curiosidades'); return false;">Curiosidades</a></li>
                <li><a href="https://www.brookasil.com/filiacao-partidaria" target="_blank">Filia√ß√£o Partid√°ria</a></li>
                <li><a href="https://www.brookasil.com/candidatura" target="_blank">Candidatura</a></li>
                <li><a href="#" onclick="mostrarEstatisticas(); return false;">Estat√≠sticas</a></li>
                <li><a href="#" onclick="mostrarFavoritos(); return false;">Favoritos</a></li>
            </ul>
            <ul class="menu-mobile" id="menu-mobile">
                <li><a href="#" onclick="mostrarHome(); toggleMenuMobile(); return false;">Home</a></li>
                <li><a href="#" onclick="filtrarPorCategoria('Pol√≠tica'); toggleMenuMobile(); return false;">Pol√≠tica</a></li>
                <li><a href="#" onclick="filtrarPorCategoria('Pol√≠cia'); toggleMenuMobile(); return false;">Pol√≠cia</a></li>
                <li><a href="#" onclick="filtrarPorCategoria('Educa√ß√£o'); toggleMenuMobile(); return false;">Educa√ß√£o</a></li>
                <li><a href="#" onclick="filtrarPorCategoria('Esporte'); toggleMenuMobile(); return false;">Esporte</a></li>
                <li><a href="#" onclick="filtrarPorCategoria('Entretenimento'); toggleMenuMobile(); return false;">Entretenimento</a></li>
                <li><a href="#" onclick="filtrarPorCategoria('Curiosidades'); toggleMenuMobile(); return false;">Curiosidades</a></li>
                <li><a href="https://www.brookasil.com/filiacao-partidaria" target="_blank">Filia√ß√£o Partid√°ria</a></li>
                <li><a href="https://www.brookasil.com/candidatura" target="_blank">Candidatura</a></li>
                <li><a href="#" onclick="mostrarEstatisticas(); toggleMenuMobile(); return false;">Estat√≠sticas</a></li>
                <li><a href="#" onclick="mostrarFavoritos(); toggleMenuMobile(); return false;">Favoritos</a></li>
            </ul>
        </div>
    </nav>

    <!-- CONTAINER PRINCIPAL -->
    <main class="container" id="main-container">
        <!-- CONTE√öDO SER√Å CARREGADO AQUI DINAMICAMENTE -->
    </main>

    <!-- NOTIFICA√á√ïES -->
    <div class="notificacoes-container" id="notificacoes-container">
        <div class="notificacoes-header">
            <h3>Notifica√ß√µes</h3>
            <button class="modal-close" onclick="toggleNotificacoes()">&times;</button>
        </div>
        <div class="notificacoes-lista" id="notificacoes-lista">
            <!-- Notifica√ß√µes ser√£o carregadas aqui -->
        </div>
    </div>

    <!-- MODAIS -->
    <div class="modal-overlay" id="modal-overlay">
        <!-- Conte√∫do dos modais ser√° injetado aqui -->
    </div>

    <!-- FOOTER -->
    <footer>
        <div class="footer-container">
            <div class="footer-col">
                <h3>g1 Brookasil</h3>
                <p>O portal de not√≠cias mais confi√°vel do pa√≠s.</p>
            </div>
            <div class="footer-col">
                <h3>Categorias</h3>
                <ul>
                    <li><a href="#" onclick="filtrarPorCategoria('Pol√≠tica'); return false;">Pol√≠tica</a></li>
                    <li><a href="#" onclick="filtrarPorCategoria('Pol√≠cia'); return false;">Pol√≠cia</a></li>
                    <li><a href="#" onclick="filtrarPorCategoria('Educa√ß√£o'); return false;">Educa√ß√£o</a></li>
                    <li><a href="#" onclick="filtrarPorCategoria('Esporte'); return false;">Esporte</a></li>
                </ul>
            </div>
            <div class="footer-col">
                <h3>Links √öteis</h3>
                <ul>
                    <li><a href="#" onclick="mostrarPerfil(); return false;">Meu Perfil</a></li>
                    <li><a href="#" onclick="mostrarFavoritos(); return false;">Favoritos</a></li>
                    <li><a href="#" onclick="mostrarEstatisticas(); return false;">Estat√≠sticas</a></li>
                </ul>
            </div>
        </div>
        <div class="copyright">
            &copy; 2026 g1 Brookasil. Todos os direitos reservados.
        </div>
    </footer>

    <!-- SCRIPTS -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
    <script>
        // ============================================
        // CONFIGURA√á√ÉO FIREBASE
        // ============================================
        const firebaseConfig = {
            apiKey: "AIzaSyBBw4l9toAKTfXV_VqkeYKHudRC4g7yk5w",
  authDomain: "g1-brookasil.firebaseapp.com",
  databaseURL: "https://g1-brookasil-default-rtdb.firebaseio.com",
  projectId: "g1-brookasil",
  storageBucket: "g1-brookasil.firebasestorage.app",
  messagingSenderId: "907359657186",
  appId: "1:907359657186:web:fc7f03c4ac693491a652bb"
        };

        // Inicializar Firebase
        firebase.initializeApp(firebaseConfig);
        const database = firebase.database();
        const auth = firebase.auth();

        // ============================================
        // VARI√ÅVEIS GLOBAIS
        // ============================================
        let usuarioAtual = null;
        let noticias = [];
        let usuarios = [];
        let notificacoes = [];
        let favoritos = [];
        let visualizacoes = {};

        // ============================================
        // FUN√á√ïES DE UTILIDADE
        // ============================================
        function formatarData(dataString) {
            const data = new Date(dataString);
            return data.toLocaleDateString('pt-BR', {
                day: '2-digit',
                month: '2-digit',
                year: 'numeric',
                hour: '2-digit',
                minute: '2-digit'
            });
        }

        function mostrarMensagem(tipo, texto) {
            // Remove mensagens anteriores
            const mensagensAntigas = document.querySelectorAll('.mensagem');
            mensagensAntigas.forEach(msg => msg.remove());

            // Cria nova mensagem
            const mensagem = document.createElement('div');
            mensagem.className = `mensagem ${tipo}`;
            mensagem.textContent = texto;
            
            // Insere no in√≠cio do container principal
            const main = document.getElementById('main-container');
            if (main.firstChild) {
                main.insertBefore(mensagem, main.firstChild);
            } else {
                main.appendChild(mensagem);
            }

            // Remove ap√≥s 5 segundos
            setTimeout(() => {
                mensagem.remove();
            }, 5000);
        }

        // ============================================
        // FUN√á√ïES DE INTERFACE
        // ============================================
        function toggleMenuMobile() {
            const menu = document.getElementById('menu-mobile');
            menu.classList.toggle('active');
        }

        function toggleNotificacoes() {
            const container = document.getElementById('notificacoes-container');
            container.classList.toggle('active');
        }

        function atualizarHora() {
            const agora = new Date();
            const hora = agora.getHours().toString().padStart(2, '0');
            const minutos = agora.getMinutes().toString().padStart(2, '0');
            document.getElementById('hora-atual').textContent = `${hora}:${minutos}`;
        }

        // ============================================
        // FUN√á√ïES DE AUTENTICA√á√ÉO
        // ============================================
        function mostrarLogin() {
            const overlay = document.getElementById('modal-overlay');
            overlay.innerHTML = `
                <div class="modal">
                    <div class="modal-header">
                        <h3>Login</h3>
                        <button class="modal-close" onclick="fecharModal()">&times;</button>
                    </div>
                    <div class="modal-body">
                        <div class="campo-form">
                            <label>Usu√°rio:</label>
                            <input type="text" id="login-usuario" placeholder="Digite seu usu√°rio">
                        </div>
                        <div class="campo-form">
                            <label>Senha:</label>
                            <input type="password" id="login-senha" placeholder="Digite sua senha">
                        </div>
                        <button class="btn" onclick="fazerLogin()">Entrar</button>
                        <p style="margin-top: 20px;">N√£o tem conta? <a href="#" onclick="mostrarCadastro()">Cadastre-se</a></p>
                    </div>
                </div>
            `;
            overlay.classList.add('active');
        }

        function mostrarCadastro() {
            const overlay = document.getElementById('modal-overlay');
            overlay.innerHTML = `
                <div class="modal">
                    <div class="modal-header">
                        <h3>Cadastro</h3>
                        <button class="modal-close" onclick="fecharModal()">&times;</button>
                    </div>
                    <div class="modal-body">
                        <div class="campo-form">
                            <label>Nome completo:</label>
                            <input type="text" id="cadastro-nome" placeholder="Digite seu nome">
                        </div>
                        <div class="campo-form">
                            <label>Usu√°rio:</label>
                            <input type="text" id="cadastro-usuario" placeholder="Escolha um usu√°rio">
                        </div>
                        <div class="campo-form">
                            <label>Senha:</label>
                            <input type="password" id="cadastro-senha" placeholder="Crie uma senha">
                        </div>
                        <div class="campo-form">
                            <label>Biografia:</label>
                            <textarea id="cadastro-bio" placeholder="Conte um pouco sobre voc√™"></textarea>
                        </div>
                        <button class="btn" onclick="fazerCadastro()">Cadastrar</button>
                    </div>
                </div>
            `;
            overlay.classList.add('active');
        }

        function fazerLogin() {
            const usuario = document.getElementById('login-usuario').value;
            const senha = document.getElementById('login-senha').value;

            if (!usuario || !senha) {
                mostrarMensagem('erro', 'Preencha todos os campos!');
                return;
            }

            // Verificar se √© o dono
            if (usuario === 'dono' && senha === 'Brookasil1234') {
                usuarioAtual = {
                    id: 'dono',
                    nome: 'Administrador',
                    usuario: 'dono',
                    cargo: 'dono',
                    bio: 'Administrador do sistema'
                };
                gerenciarSessao();
                fecharModal();
                mostrarHome();
                return;
            }

            // Buscar usu√°rio no banco de dados
            database.ref('usuarios').once('value')
                .then(snapshot => {
                    const usuariosDB = snapshot.val() || {};
                    let usuarioEncontrado = null;

                    for (const id in usuariosDB) {
                        if (usuariosDB[id].usuario === usuario) {
                            usuarioEncontrado = { id, ...usuariosDB[id] };
                            break;
                        }
                    }

                    if (usuarioEncontrado) {
                        usuarioAtual = usuarioEncontrado;
                        gerenciarSessao();
                        fecharModal();
                        mostrarHome();
                        mostrarMensagem('sucesso', `Bem-vindo, ${usuarioAtual.nome}!`);
                    } else {
                        mostrarMensagem('erro', 'Usu√°rio n√£o encontrado!');
                    }
                });
        }

        function fazerCadastro() {
            const nome = document.getElementById('cadastro-nome').value;
            const usuario = document.getElementById('cadastro-usuario').value;
            const senha = document.getElementById('cadastro-senha').value;
            const bio = document.getElementById('cadastro-bio').value;

            if (!nome || !usuario || !senha) {
                mostrarMensagem('erro', 'Preencha todos os campos obrigat√≥rios!');
                return;
            }

            if (usuario === 'dono') {
                mostrarMensagem('erro', 'Usu√°rio "dono" √© reservado!');
                return;
            }

            const novoUsuario = {
                nome,
                usuario,
                bio: bio || '',
                cargo: 'usuario',
                foto: ''
            };

            database.ref('usuarios').push(novoUsuario)
                .then(() => {
                    mostrarMensagem('sucesso', 'Cadastro realizado com sucesso!');
                    mostrarLogin();
                })
                .catch(error => {
                    mostrarMensagem('erro', 'Erro ao cadastrar: ' + error.message);
                });
        }

        function fazerLogout() {
            usuarioAtual = null;
            gerenciarSessao();
            mostrarHome();
            mostrarMensagem('sucesso', 'Logout realizado com sucesso!');
        }

        function gerenciarSessao() {
            const loginBtn = document.getElementById('login-btn');
            const perfilBtn = document.getElementById('perfil-btn');
            const painelBtn = document.getElementById('painel-btn');
            const notificacaoBtn = document.getElementById('notificacao-btn');

            if (usuarioAtual) {
                loginBtn.style.display = 'none';
                perfilBtn.style.display = 'inline-block';
                notificacaoBtn.style.display = 'inline-block';
                
                if (usuarioAtual.cargo === 'jornalista' || usuarioAtual.cargo === 'dono') {
                    painelBtn.style.display = 'inline-block';
                } else {
                    painelBtn.style.display = 'none';
                }
                
                // Carregar notifica√ß√µes do usu√°rio
                carregarNotificacoes();
                // Carregar favoritos do usu√°rio
                carregarFavoritos();
            } else {
                loginBtn.style.display = 'inline-block';
                perfilBtn.style.display = 'none';
                painelBtn.style.display = 'none';
                notificacaoBtn.style.display = 'none';
            }
        }

        // ============================================
        // FUN√á√ïES DE NOT√çCIAS
        // ============================================
        function carregarNoticias() {
            database.ref('noticias').on('value', snapshot => {
                noticias = [];
                const dados = snapshot.val() || {};
                
                for (const id in dados) {
                    noticias.push({
                        id,
                        ...dados[id],
                        // Garantir que os contadores existam
                        curtidas: dados[id].curtidas || 0,
                        descurtidas: dados[id].descurtidas || 0,
                        republicacoes: dados[id].republicacoes || 0
                    });
                }
                
                // Ordenar por data (mais recente primeiro)
                noticias.sort((a, b) => new Date(b.data) - new Date(a.data));
                
                // Atualizar a interface
                if (document.getElementById('main-container').innerHTML.includes('manchete-principal')) {
                    mostrarHome();
                }
            });
        }

        function mostrarHome() {
            const main = document.getElementById('main-container');
            
            if (noticias.length === 0) {
                main.innerHTML = `
                    <div class="secao" style="grid-column: 1 / -1; text-align: center; padding: 50px;">
                        <h2>Carregando not√≠cias...</h2>
                        <div class="skeleton" style="height: 300px; margin: 20px 0;"></div>
                        <div class="skeleton" style="height: 200px; margin: 20px 0;"></div>
                    </div>
                `;
                return;
            }

            // Manchete principal (√∫ltima not√≠cia)
            const manchete = noticias[0];
            
            // Not√≠cias restantes
            const outrasNoticias = noticias.slice(1);
            
            // Separar por categorias para as se√ß√µes
            const maisLidas = [...noticias]
                .sort((a, b) => (visualizacoes[b.id] || 0) - (visualizacoes[a.id] || 0))
                .slice(0, 5);
            
            const emAlta = [...noticias]
                .sort((a, b) => (b.curtidas || 0) - (a.curtidas || 0))
                .slice(0, 5);

            main.innerHTML = `
                <!-- MANCHETE PRINCIPAL -->
                <div class="manchete-principal" onclick="mostrarNoticia('${manchete.id}')">
                    ${manchete.imagemBase64 ? 
                        `<img src="${manchete.imagemBase64}" alt="${manchete.titulo}" class="manchete-imagem">` :
                        `<div class="skeleton" style="height: 100%;"></div>`
                    }
                    <div class="manchete-conteudo">
                        <h1>${manchete.titulo}</h1>
                        <p>${manchete.subtitulo}</p>
                        <div class="card-meta">
                            <span>${manchete.categoria}</span>
                            <span>${formatarData(manchete.data)}</span>
                        </div>
                    </div>
                </div>

                <!-- CONTE√öDO PRINCIPAL -->
                <div class="conteudo-principal">
                    <!-- NOT√çCIAS RECENTES -->
                    <div class="secao">
                        <h2>√öltimas Not√≠cias</h2>
                        <div class="lista-noticias">
                            ${outrasNoticias.slice(0, 6).map(noticia => `
                                <div class="card-noticia" onclick="mostrarNoticia('${noticia.id}')">
                                    <div class="card-imagem-container">
                                        ${noticia.imagemBase64 ? 
                                            `<img src="${noticia.imagemBase64}" alt="${noticia.titulo}" class="card-imagem">` :
                                            `<div class="skeleton" style="height: 100%;"></div>`
                                        }
                                    </div>
                                    <div class="card-conteudo">
                                        <div class="card-categoria">${noticia.categoria}</div>
                                        <h3 class="card-titulo">${noticia.titulo}</h3>
                                        <p>${noticia.subtitulo.substring(0, 100)}...</p>
                                        <div class="tags-container">
                                            ${noticia.categoria ? `<span class="tag">${noticia.categoria}</span>` : ''}
                                            <span class="tag">Not√≠cia</span>
                                        </div>
                                        <div class="card-meta">
                                            <span>Por ${noticia.autor}</span>
                                            <span>${formatarData(noticia.data).split(' ')[0]}</span>
                                        </div>
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                    </div>

                    <!-- FILTROS AVAN√áADOS -->
                    <div class="secao">
                        <h2>Filtrar Not√≠cias</h2>
                        <div style="display: flex; gap: 10px; flex-wrap: wrap;">
                            <select id="filtro-categoria" class="campo-form" style="flex: 1; min-width: 200px;">
                                <option value="">Todas as categorias</option>
                                <option value="Pol√≠tica">Pol√≠tica</option>
                                <option value="Pol√≠cia">Pol√≠cia</option>
                                <option value="Educa√ß√£o">Educa√ß√£o</option>
                                <option value="Esporte">Esporte</option>
                                <option value="Entretenimento">Entretenimento</option>
                                <option value="Curiosidades">Curiosidades</option>
                            </select>
                            <select id="filtro-data" class="campo-form" style="flex: 1; min-width: 200px;">
                                <option value="">Qualquer data</option>
                                <option value="hoje">Hoje</option>
                                <option value="semana">Esta semana</option>
                                <option value="mes">Este m√™s</option>
                            </select>
                            <button class="btn" onclick="aplicarFiltros()">Aplicar Filtros</button>
                        </div>
                    </div>
                </div>

                <!-- SIDEBAR -->
                <div class="sidebar">
                    <!-- MAIS LIDAS -->
                    <div class="secao">
                        <h2>üìå Mais Lidas</h2>
                        <div style="display: flex; flex-direction: column; gap: 15px;">
                            ${maisLidas.map((noticia, index) => `
                                <div style="display: flex; gap: 10px; cursor: pointer; padding: 10px; border-radius: 5px; transition: background-color 0.2s;" 
                                     onclick="mostrarNoticia('${noticia.id}')"
                                     onmouseover="this.style.backgroundColor='var(--cinza-claro)'"
                                     onmouseout="this.style.backgroundColor='transparent'">
                                    <div style="background: var(--vermelho-g1); color: white; width: 25px; height: 25px; display: flex; align-items: center; justify-content: center; border-radius: 50%; font-weight: bold;">
                                        ${index + 1}
                                    </div>
                                    <div style="flex: 1;">
                                        <h4 style="margin: 0 0 5px 0;">${noticia.titulo.substring(0, 50)}${noticia.titulo.length > 50 ? '...' : ''}</h4>
                                        <div style="font-size: 0.8rem; color: var(--cinza-escuro);">
                                            ${visualizacoes[noticia.id] || 0} visualiza√ß√µes
                                        </div>
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                    </div>

                    <!-- EM ALTA AGORA -->
                    <div class="secao">
                        <h2>üî• Em Alta Agora</h2>
                        <div style="display: flex; flex-direction: column; gap: 15px;">
                            ${emAlta.map(noticia => `
                                <div style="cursor: pointer; padding: 10px; border-radius: 5px; transition: background-color 0.2s;" 
                                     onclick="mostrarNoticia('${noticia.id}')"
                                     onmouseover="this.style.backgroundColor='var(--cinza-claro)'"
                                     onmouseout="this.style.backgroundColor='transparent'">
                                    <h4 style="margin: 0 0 5px 0;">${noticia.titulo.substring(0, 60)}${noticia.titulo.length > 60 ? '...' : ''}</h4>
                                    <div style="display: flex; justify-content: space-between; font-size: 0.8rem; color: var(--cinza-escuro);">
                                        <span>üëç ${noticia.curtidas || 0}</span>
                                        <span>${formatarData(noticia.data).split(' ')[0]}</span>
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                    </div>

                    <!-- LINHA DO TEMPO -->
                    <div class="secao">
                        <h2>üïí Linha do Tempo</h2>
                        <div style="max-height: 400px; overflow-y: auto; padding-right: 10px;">
                            ${noticias.slice(0, 10).map(noticia => `
                                <div style="margin-bottom: 15px; padding-left: 15px; border-left: 2px solid var(--vermelho-g1);">
                                    <div style="font-size: 0.8rem; color: var(--cinza-escuro); margin-bottom: 5px;">
                                        ${formatarData(noticia.data)}
                                    </div>
                                    <div style="cursor: pointer;" onclick="mostrarNoticia('${noticia.id}')">
                                        ${noticia.titulo.substring(0, 70)}${noticia.titulo.length > 70 ? '...' : ''}
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                </div>
            `;

            // Registrar visualiza√ß√£o da manchete
            registrarVisualizacao(manchete.id);
        }

        function mostrarNoticia(id) {
            const noticia = noticias.find(n => n.id === id);
            if (!noticia) return;

            // Registrar visualiza√ß√£o
            registrarVisualizacao(id);

            // Contar visualiza√ß√µes
            visualizacoes[id] = (visualizacoes[id] || 0) + 1;

            // Buscar coment√°rios
            database.ref(`comentarios/${id}`).once('value')
                .then(snapshot => {
                    const comentarios = snapshot.val() || {};
                    const listaComentarios = Object.entries(comentarios).map(([comId, com]) => `
                        <div class="comentario">
                            <div class="comentario-header">
                                <span class="comentario-autor">${com.autor}</span>
                                <span class="comentario-data">${formatarData(com.data)}</span>
                            </div>
                            <div class="comentario-texto">${com.texto}</div>
                            ${usuarioAtual && (usuarioAtual.id === com.autorId || usuarioAtual.cargo === 'dono') ? 
                                `<button class="btn btn-small btn-danger" onclick="apagarComentario('${id}', '${comId}')">Apagar</button>` : 
                                ''}
                        </div>
                    `).join('');

                    const main = document.getElementById('main-container');
                    main.innerHTML = `
                        <div class="secao" style="grid-column: 1 / -1;">
                            <button class="btn btn-secondary" onclick="mostrarHome()">‚Üê Voltar para Home</button>
                            
                            <h1 style="margin-top: 30px;">${noticia.titulo}</h1>
                            <h3 style="color: var(--cinza-escuro); margin-bottom: 30px;">${noticia.subtitulo}</h3>
                            
                            ${noticia.imagemBase64 ? 
                                `<img src="${noticia.imagemBase64}" alt="${noticia.titulo}" style="width: 100%; max-height: 500px; object-fit: cover; border-radius: 10px; margin-bottom: 30px;">` : 
                                ''}
                            
                            <div style="font-size: 1.2rem; line-height: 1.8; margin-bottom: 30px;">
                                ${noticia.conteudo.split('\n').map(p => `<p>${p}</p>`).join('')}
                            </div>
                            
                            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 30px; padding: 20px; background: var(--cinza-claro); border-radius: 10px;">
                                <div>
                                    <div style="font-weight: bold;">Autor: ${noticia.autor}</div>
                                    <div style="color: var(--cinza-escuro);">Publicado em: ${formatarData(noticia.data)}</div>
                                    <div style="margin-top: 10px;">
                                        <button class="tag" onclick="mostrarPerfilJornalista('${noticia.autorId}')">Ver perfil do autor</button>
                                    </div>
                                </div>
                                <div style="text-align: right;">
                                    <div>Categoria: <strong>${noticia.categoria}</strong></div>
                                    <div style="margin-top: 10px;">
                                        ${noticia.tags ? noticia.tags.split(',').map(tag => `<span class="tag">${tag.trim()}</span>`).join(' ') : ''}
                                    </div>
                                </div>
                            </div>

                            <!-- A√á√ïES DA NOT√çCIA -->
                            <div class="acoes-noticia">
                                <button class="acao-btn ${usuarioAtual && usuarioAtual.curtidas && usuarioAtual.curtidas[id] ? 'curtido' : ''}" 
                                        onclick="curtirNoticia('${id}')" ${!usuarioAtual ? 'disabled' : ''}>
                                    <i class="fas fa-thumbs-up"></i>
                                    <span id="curtidas-${id}">${noticia.curtidas || 0}</span>
                                </button>
                                
                                <button class="acao-btn ${usuarioAtual && usuarioAtual.descurtidas && usuarioAtual.descurtidas[id] ? 'descurtido' : ''}" 
                                        onclick="descurtirNoticia('${id}')" ${!usuarioAtual ? 'disabled' : ''}>
                                    <i class="fas fa-thumbs-down"></i>
                                    <span id="descurtidas-${id}">${noticia.descurtidas || 0}</span>
                                </button>
                                
                                <button class="acao-btn ${usuarioAtual && usuarioAtual.republicacoes && usuarioAtual.republicacoes[id] ? 'republicado' : ''}" 
                                        onclick="republicarNoticia('${id}')" ${!usuarioAtual ? 'disabled' : ''}>
                                    <i class="fas fa-retweet"></i>
                                    <span id="republicacoes-${id}">${noticia.republicacoes || 0}</span>
                                </button>
                                
                                <button class="acao-btn ${usuarioAtual && favoritos.includes(id) ? 'favoritado' : ''}" 
                                        onclick="favoritarNoticia('${id}')" ${!usuarioAtual ? 'disabled' : ''}>
                                    <i class="fas fa-star"></i>
                                    <span>Favoritar</span>
                                </button>

                                ${usuarioAtual && (usuarioAtual.id === noticia.autorId || usuarioAtual.cargo === 'dono') ? `
                                    <button class="btn btn-small" onclick="editarNoticia('${id}')">Editar</button>
                                    <button class="btn btn-small btn-danger" onclick="excluirNoticia('${id}')">Excluir</button>
                                ` : ''}
                            </div>

                            <!-- COMENT√ÅRIOS -->
                            <div class="comentarios-container">
                                <h3>Coment√°rios</h3>
                                
                                ${usuarioAtual ? `
                                    <div class="form-comentario">
                                        <textarea class="campo-texto" id="novo-comentario-${id}" placeholder="Digite seu coment√°rio..."></textarea>
                                        <button class="btn" onclick="adicionarComentario('${id}')">Enviar Coment√°rio</button>
                                    </div>
                                ` : `
                                    <p>Fa√ßa login para comentar.</p>
                                `}
                                
                                <div class="lista-comentarios">
                                    ${listaComentarios || '<p>Seja o primeiro a comentar!</p>'}
                                </div>
                            </div>
                        </div>
                    `;
                });
        }

        function registrarVisualizacao(idNoticia) {
            if (!usuarioAtual) return;
            
            // Atualizar contador de visualiza√ß√µes local
            visualizacoes[idNoticia] = (visualizacoes[idNoticia] || 0) + 1;
        }

        // ============================================
        // FUN√á√ïES DE INTERA√á√ÉO COM NOT√çCIAS
        // ============================================
        function curtirNoticia(id) {
            if (!usuarioAtual) {
                mostrarMensagem('erro', 'Fa√ßa login para curtir!');
                return;
            }

            const noticiaRef = database.ref(`noticias/${id}`);
            noticiaRef.transaction(noticia => {
                if (noticia) {
                    noticia.curtidas = (noticia.curtidas || 0) + 1;
                    
                    // Criar notifica√ß√£o para o autor
                    if (noticia.autorId && noticia.autorId !== usuarioAtual.id) {
                        criarNotificacao(noticia.autorId, 'curtida', id, usuarioAtual.nome);
                    }
                }
                return noticia;
            });

            // Atualizar interface
            const curtidasEl = document.getElementById(`curtidas-${id}`);
            if (curtidasEl) {
                curtidasEl.textContent = parseInt(curtidasEl.textContent) + 1;
            }
        }

        function descurtirNoticia(id) {
            if (!usuarioAtual) {
                mostrarMensagem('erro', 'Fa√ßa login para descurtir!');
                return;
            }

            const noticiaRef = database.ref(`noticias/${id}`);
            noticiaRef.transaction(noticia => {
                if (noticia) {
                    noticia.descurtidas = (noticia.descurtidas || 0) + 1;
                }
                return noticia;
            });

            const descurtidasEl = document.getElementById(`descurtidas-${id}`);
            if (descurtidasEl) {
                descurtidasEl.textContent = parseInt(descurtidasEl.textContent) + 1;
            }
        }

        function republicarNoticia(id) {
            if (!usuarioAtual) {
                mostrarMensagem('erro', 'Fa√ßa login para republicar!');
                return;
            }

            const noticiaRef = database.ref(`noticias/${id}`);
            noticiaRef.transaction(noticia => {
                if (noticia) {
                    noticia.republicacoes = (noticia.republicacoes || 0) + 1;
                    
                    // Criar notifica√ß√£o para o autor
                    if (noticia.autorId && noticia.autorId !== usuarioAtual.id) {
                        criarNotificacao(noticia.autorId, 'republicacao', id, usuarioAtual.nome);
                    }
                }
                return noticia;
            });

            const repEl = document.getElementById(`republicacoes-${id}`);
            if (repEl) {
                repEl.textContent = parseInt(repEl.textContent) + 1;
            }
        }

        function favoritarNoticia(id) {
            if (!usuarioAtual) {
                mostrarMensagem('erro', 'Fa√ßa login para favoritar!');
                return;
            }

            const index = favoritos.indexOf(id);
            if (index === -1) {
                favoritos.push(id);
                mostrarMensagem('sucesso', 'Not√≠cia adicionada aos favoritos!');
            } else {
                favoritos.splice(index, 1);
                mostrarMensagem('sucesso', 'Not√≠cia removida dos favoritos!');
            }

            // Salvar no localStorage
            localStorage.setItem(`favoritos_${usuarioAtual.id}`, JSON.stringify(favoritos));
            
            // Recarregar a not√≠cia para atualizar o bot√£o
            mostrarNoticia(id);
        }

        function adicionarComentario(idNoticia) {
            if (!usuarioAtual) {
                mostrarMensagem('erro', 'Fa√ßa login para comentar!');
                return;
            }

            const texto = document.getElementById(`novo-comentario-${idNoticia}`).value;
            if (!texto.trim()) {
                mostrarMensagem('erro', 'Digite um coment√°rio!');
                return;
            }

            const comentario = {
                autor: usuarioAtual.nome,
                autorId: usuarioAtual.id,
                texto: texto.trim(),
                data: new Date().toISOString()
            };

            database.ref(`comentarios/${idNoticia}`).push(comentario)
                .then(() => {
                    document.getElementById(`novo-comentario-${idNoticia}`).value = '';
                    
                    // Criar notifica√ß√£o para o autor da not√≠cia
                    const noticia = noticias.find(n => n.id === idNoticia);
                    if (noticia && noticia.autorId !== usuarioAtual.id) {
                        criarNotificacao(noticia.autorId, 'comentario', idNoticia, usuarioAtual.nome);
                    }
                    
                    // Recarregar a not√≠cia para mostrar o novo coment√°rio
                    mostrarNoticia(idNoticia);
                });
        }

        function apagarComentario(idNoticia, idComentario) {
            if (!confirm('Tem certeza que deseja apagar este coment√°rio?')) return;

            database.ref(`comentarios/${idNoticia}/${idComentario}`).remove()
                .then(() => {
                    mostrarNoticia(idNoticia);
                });
        }

        // ============================================
        // FUN√á√ïES DE PERFIL
        // ============================================
        function mostrarPerfil() {
            if (!usuarioAtual) {
                mostrarLogin();
                return;
            }

            // Buscar not√≠cias do usu√°rio
            const noticiasUsuario = noticias.filter(n => n.autorId === usuarioAtual.id);

            const main = document.getElementById('main-container');
            main.innerHTML = `
                <div class="secao" style="grid-column: 1 / -1;">
                    <button class="btn btn-secondary" onclick="mostrarHome()">‚Üê Voltar para Home</button>
                    
                    <div class="perfil-container">
                        ${usuarioAtual.foto ? 
                            `<img src="${usuarioAtual.foto}" alt="${usuarioAtual.nome}" class="perfil-foto">` :
                            `<div class="perfil-foto skeleton"></div>`
                        }
                        
                        <h1 class="perfil-nome">${usuarioAtual.nome}</h1>
                        <div class="perfil-usuario">@${usuarioAtual.usuario}</div>
                        
                        <div class="perfil-bio">${usuarioAtual.bio || 'Sem biografia'}</div>
                        
                        <div style="background: var(--cinza-claro); padding: 20px; border-radius: 10px; width: 100%; max-width: 500px; margin-bottom: 30px;">
                            <div style="display: flex; justify-content: space-around; text-align: center;">
                                <div>
                                    <div style="font-size: 2rem; font-weight: bold; color: var(--vermelho-g1);">${noticiasUsuario.length}</div>
                                    <div>Not√≠cias</div>
                                </div>
                                <div>
                                    <div style="font-size: 2rem; font-weight: bold; color: var(--verde);">${favoritos.length}</div>
                                    <div>Favoritos</div>
                                </div>
                                <div>
                                    <div style="font-size: 2rem; font-weight: bold; color: var(--azul);">${usuarioAtual.cargo}</div>
                                    <div>Cargo</div>
                                </div>
                            </div>
                        </div>

                        <div style="display: flex; gap: 10px; flex-wrap: wrap; justify-content: center;">
                            <button class="btn" onclick="editarPerfil()">Editar Perfil</button>
                            <button class="btn" onclick="alterarFoto()">Alterar Foto</button>
                            <button class="btn btn-danger" onclick="fazerLogout()">Sair</button>
                        </div>
                    </div>

                    ${noticiasUsuario.length > 0 ? `
                        <div style="margin-top: 50px;">
                            <h2>Minhas Not√≠cias</h2>
                            <div class="lista-noticias">
                                ${noticiasUsuario.slice(0, 6).map(noticia => `
                                    <div class="card-noticia" onclick="mostrarNoticia('${noticia.id}')">
                                        <div class="card-imagem-container">
                                            ${noticia.imagemBase64 ? 
                                                `<img src="${noticia.imagemBase64}" alt="${noticia.titulo}" class="card-imagem">` :
                                                `<div class="skeleton" style="height: 100%;"></div>`
                                            }
                                        </div>
                                        <div class="card-conteudo">
                                            <div class="card-categoria">${noticia.categoria}</div>
                                            <h3 class="card-titulo">${noticia.titulo}</h3>
                                            <div class="card-meta">
                                                <span>${formatarData(noticia.data)}</span>
                                                <div>
                                                    <small>üëç ${noticia.curtidas || 0}</small>
                                                    <small style="margin-left: 10px;">üí¨ ${Object.keys(noticia.comentarios || {}).length}</small>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                    ` : ''}
                </div>
            `;
        }

        function mostrarPerfilJornalista(autorId) {
            // Buscar informa√ß√µes do jornalista
            database.ref('usuarios').once('value')
                .then(snapshot => {
                    const usuariosDB = snapshot.val() || {};
                    const jornalista = usuariosDB[autorId];
                    
                    if (!jornalista) return;
                    
                    // Buscar not√≠cias do jornalista
                    const noticiasJornalista = noticias.filter(n => n.autorId === autorId);

                    const overlay = document.getElementById('modal-overlay');
                    overlay.innerHTML = `
                        <div class="modal">
                            <div class="modal-header">
                                <h3>Perfil do Jornalista</h3>
                                <button class="modal-close" onclick="fecharModal()">&times;</button>
                            </div>
                            <div class="modal-body">
                                <div class="perfil-container">
                                    ${jornalista.foto ? 
                                        `<img src="${jornalista.foto}" alt="${jornalista.nome}" class="perfil-foto">` :
                                        `<div class="perfil-foto skeleton"></div>`
                                    }
                                    
                                    <h3>${jornalista.nome}</h3>
                                    <div class="perfil-usuario">@${jornalista.usuario}</div>
                                    <div class="perfil-bio">${jornalista.bio || 'Sem biografia'}</div>
                                    
                                    <div style="background: var(--cinza-claro); padding: 20px; border-radius: 10px; width: 100%; margin-bottom: 20px;">
                                        <div style="text-align: center; font-size: 2rem; font-weight: bold; color: var(--vermelho-g1);">
                                            ${noticiasJornalista.length}
                                        </div>
                                        <div style="text-align: center;">Not√≠cias publicadas</div>
                                    </div>
                                </div>
                                
                                ${noticiasJornalista.length > 0 ? `
                                    <h4>√öltimas publica√ß√µes:</h4>
                                    <div style="max-height: 300px; overflow-y: auto;">
                                        ${noticiasJornalista.slice(0, 10).map(noticia => `
                                            <div style="padding: 10px; border-bottom: 1px solid var(--cinza-medio); cursor: pointer;" 
                                                 onclick="mostrarNoticia('${noticia.id}'); fecharModal();">
                                                <div style="font-weight: bold;">${noticia.titulo.substring(0, 60)}${noticia.titulo.length > 60 ? '...' : ''}</div>
                                                <div style="font-size: 0.8rem; color: var(--cinza-escuro);">
                                                    ${formatarData(noticia.data)} ‚Ä¢ ${noticia.categoria}
                                                </div>
                                            </div>
                                        `).join('')}
                                    </div>
                                ` : ''}
                            </div>
                        </div>
                    `;
                    overlay.classList.add('active');
                });
        }

        function editarPerfil() {
            const overlay = document.getElementById('modal-overlay');
            overlay.innerHTML = `
                <div class="modal">
                    <div class="modal-header">
                        <h3>Editar Perfil</h3>
                        <button class="modal-close" onclick="fecharModal()">&times;</button>
                    </div>
                    <div class="modal-body">
                        <div class="campo-form">
                            <label>Nome:</label>
                            <input type="text" id="editar-nome" value="${usuarioAtual.nome}">
                        </div>
                        <div class="campo-form">
                            <label>Biografia:</label>
                            <textarea id="editar-bio">${usuarioAtual.bio || ''}</textarea>
                        </div>
                        <button class="btn" onclick="salvarPerfil()">Salvar Altera√ß√µes</button>
                    </div>
                </div>
            `;
            overlay.classList.add('active');
        }

        function salvarPerfil() {
            const nome = document.getElementById('editar-nome').value;
            const bio = document.getElementById('editar-bio').value;

            database.ref(`usuarios/${usuarioAtual.id}`).update({
                nome,
                bio
            })
            .then(() => {
                usuarioAtual.nome = nome;
                usuarioAtual.bio = bio;
                mostrarPerfil();
                fecharModal();
                mostrarMensagem('sucesso', 'Perfil atualizado com sucesso!');
            });
        }

        function alterarFoto() {
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = 'image/*';
            
            input.onchange = function(e) {
                const file = e.target.files[0];
                if (!file) return;
                
                const reader = new FileReader();
                reader.onload = function(event) {
                    const fotoBase64 = event.target.result;
                    
                    database.ref(`usuarios/${usuarioAtual.id}`).update({
                        foto: fotoBase64
                    })
                    .then(() => {
                        usuarioAtual.foto = fotoBase64;
                        mostrarPerfil();
                        mostrarMensagem('sucesso', 'Foto atualizada com sucesso!');
                    });
                };
                reader.readAsDataURL(file);
            };
            
            input.click();
        }

        // ============================================
        // FUN√á√ïES DE PAINEL (JORNALISTA/DONO)
        // ============================================
        function mostrarPainel() {
            if (!usuarioAtual || (usuarioAtual.cargo !== 'jornalista' && usuarioAtual.cargo !== 'dono')) {
                mostrarMensagem('erro', 'Acesso n√£o autorizado!');
                return;
            }

            const main = document.getElementById('main-container');
            
            if (usuarioAtual.cargo === 'dono') {
                // Painel do dono
                database.ref('usuarios').once('value')
                    .then(snapshot => {
                        const usuariosDB = snapshot.val() || {};
                        const listaUsuarios = Object.entries(usuariosDB).map(([id, user]) => `
                            <div style="display: flex; justify-content: space-between; align-items: center; padding: 15px; border-bottom: 1px solid var(--cinza-medio);">
                                <div>
                                    <div style="font-weight: bold;">${user.nome}</div>
                                    <div style="color: var(--cinza-escuro); font-size: 0.9rem;">@${user.usuario} ‚Ä¢ ${user.cargo}</div>
                                    ${user.bio ? `<div style="margin-top: 5px;">${user.bio.substring(0, 100)}${user.bio.length > 100 ? '...' : ''}</div>` : ''}
                                </div>
                                <div style="display: flex; gap: 10px;">
                                    <select onchange="alterarCargo('${id}', this.value)" style="padding: 5px; border-radius: 5px;">
                                        <option value="usuario" ${user.cargo === 'usuario' ? 'selected' : ''}>Usu√°rio</option>
                                        <option value="jornalista" ${user.cargo === 'jornalista' ? 'selected' : ''}>Jornalista</option>
                                    </select>
                                    <button class="btn btn-small btn-danger" onclick="excluirUsuario('${id}')">Excluir</button>
                                </div>
                            </div>
                        `).join('');

                        main.innerHTML = `
                            <div class="secao" style="grid-column: 1 / -1;">
                                <button class="btn btn-secondary" onclick="mostrarHome()">‚Üê Voltar para Home</button>
                                <h1 style="margin-top: 30px;">Painel do Administrador</h1>
                                
                                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; margin: 30px 0;">
                                    <div class="secao" onclick="mostrarEstatisticas()" style="cursor: pointer;">
                                        <h3>üìä Estat√≠sticas</h3>
                                        <p>Ver estat√≠sticas completas do site</p>
                                    </div>
                                    <div class="secao" onclick="criarNoticia()" style="cursor: pointer;">
                                        <h3>üìù Criar Not√≠cia</h3>
                                        <p>Criar uma nova not√≠cia</p>
                                    </div>
                                    <div class="secao" onclick="verHistorico()" style="cursor: pointer;">
                                        <h3>üìã Hist√≥rico</h3>
                                        <p>Ver hist√≥rico de a√ß√µes</p>
                                    </div>
                                </div>

                                <h2>Gerenciar Usu√°rios</h2>
                                <div style="background: var(--branco); border-radius: 10px; overflow: hidden; margin-top: 20px;">
                                    ${listaUsuarios || '<p style="padding: 20px; text-align: center;">Nenhum usu√°rio encontrado.</p>'}
                                </div>
                            </div>
                        `;
                    });
            } else {
                // Painel do jornalista
                const noticiasJornalista = noticias.filter(n => n.autorId === usuarioAtual.id);
                
                main.innerHTML = `
                    <div class="secao" style="grid-column: 1 / -1;">
                        <button class="btn btn-secondary" onclick="mostrarHome()">‚Üê Voltar para Home</button>
                        <h1 style="margin-top: 30px;">Painel do Jornalista</h1>
                        
                        <div style="text-align: center; margin: 40px 0;">
                            <button class="btn" onclick="criarNoticia()" style="padding: 20px 40px; font-size: 1.2rem;">
                                <i class="fas fa-plus" style="margin-right: 10px;"></i>
                                Criar Nova Not√≠cia
                            </button>
                        </div>

                        ${noticiasJornalista.length > 0 ? `
                            <h2>Minhas Not√≠cias Publicadas</h2>
                            <div style="background: var(--cinza-claro); border-radius: 10px; padding: 20px; margin-top: 20px;">
                                ${noticiasJornalista.map(noticia => `
                                    <div style="display: flex; justify-content: space-between; align-items: center; padding: 15px; background: var(--branco); border-radius: 5px; margin-bottom: 10px;">
                                        <div style="flex: 1; cursor: pointer;" onclick="mostrarNoticia('${noticia.id}')">
                                            <div style="font-weight: bold;">${noticia.titulo}</div>
                                            <div style="color: var(--cinza-escuro); font-size: 0.9rem;">
                                                ${noticia.categoria} ‚Ä¢ ${formatarData(noticia.data)}
                                            </div>
                                        </div>
                                        <div style="display: flex; gap: 10px;">
                                            <button class="btn btn-small" onclick="editarNoticia('${noticia.id}')">Editar</button>
                                            <button class="btn btn-small btn-danger" onclick="excluirNoticia('${noticia.id}')">Excluir</button>
                                        </div>
                                    </div>
                                `).join('')}
                            </div>
                        ` : `
                            <div style="text-align: center; padding: 50px; background: var(--cinza-claro); border-radius: 10px; margin-top: 30px;">
                                <h3>Voc√™ ainda n√£o publicou nenhuma not√≠cia</h3>
                                <p style="margin: 20px 0;">Comece criando sua primeira not√≠cia!</p>
                                <button class="btn" onclick="criarNoticia()">Criar Primeira Not√≠cia</button>
                            </div>
                        `}
                    </div>
                `;
            }
        }

        function criarNoticia() {
            const overlay = document.getElementById('modal-overlay');
            overlay.innerHTML = `
                <div class="modal">
                    <div class="modal-header">
                        <h3>${usuarioAtual.cargo === 'dono' ? 'Criar Not√≠cia (Admin)' : 'Criar Nova Not√≠cia'}</h3>
                        <button class="modal-close" onclick="fecharModal()">&times;</button>
                    </div>
                    <div class="modal-body">
                        <div class="campo-form">
                            <label>T√≠tulo:</label>
                            <input type="text" id="nova-titulo" placeholder="Digite o t√≠tulo da not√≠cia">
                        </div>
                        <div class="campo-form">
                            <label>Subt√≠tulo:</label>
                            <input type="text" id="nova-subtitulo" placeholder="Digite o subt√≠tulo">
                        </div>
                        <div class="campo-form">
                            <label>Categoria:</label>
                            <select id="nova-categoria">
                                <option value="Pol√≠tica">Pol√≠tica</option>
                                <option value="Pol√≠cia">Pol√≠cia</option>
                                <option value="Educa√ß√£o">Educa√ß√£o</option>
                                <option value="Esporte">Esporte</option>
                                <option value="Entretenimento">Entretenimento</option>
                                <option value="Curiosidades">Curiosidades</option>
                            </select>
                        </div>
                        <div class="campo-form">
                            <label>Conte√∫do:</label>
                            <textarea id="nova-conteudo" placeholder="Digite o conte√∫do da not√≠cia" rows="10"></textarea>
                        </div>
                        <div class="campo-form">
                            <label>Tags (separadas por v√≠rgula):</label>
                            <input type="text" id="nova-tags" placeholder="Ex: Elei√ß√£o, Justi√ßa, Cidade">
                        </div>
                        <div class="campo-form">
                            <label>Imagem:</label>
                            <input type="file" id="nova-imagem" accept="image/*">
                            <small>Selecione uma imagem para a not√≠cia</small>
                        </div>
                        <button class="btn" onclick="salvarNovaNoticia()">Publicar Not√≠cia</button>
                    </div>
                </div>
            `;
            overlay.classList.add('active');
        }

        function salvarNovaNoticia() {
            const titulo = document.getElementById('nova-titulo').value;
            const subtitulo = document.getElementById('nova-subtitulo').value;
            const categoria = document.getElementById('nova-categoria').value;
            const conteudo = document.getElementById('nova-conteudo').value;
            const tags = document.getElementById('nova-tags').value;
            const imagemInput = document.getElementById('nova-imagem');

            if (!titulo || !subtitulo || !conteudo) {
                mostrarMensagem('erro', 'Preencha todos os campos obrigat√≥rios!');
                return;
            }

            const novaNoticia = {
                titulo,
                subtitulo,
                categoria,
                conteudo,
                tags,
                autor: usuarioAtual.nome,
                autorId: usuarioAtual.id,
                data: new Date().toISOString(),
                curtidas: 0,
                descurtidas: 0,
                republicacoes: 0
            };

            // Processar imagem se houver
            if (imagemInput.files.length > 0) {
                const file = imagemInput.files[0];
                const reader = new FileReader();
                
                reader.onload = function(event) {
                    novaNoticia.imagemBase64 = event.target.result;
                    publicarNoticiaNoBanco(novaNoticia);
                };
                
                reader.readAsDataURL(file);
            } else {
                publicarNoticiaNoBanco(novaNoticia);
            }
        }

        function publicarNoticiaNoBanco(noticia) {
            database.ref('noticias').push(noticia)
                .then(() => {
                    fecharModal();
                    mostrarMensagem('sucesso', 'Not√≠cia publicada com sucesso!');
                    
                    if (usuarioAtual.cargo === 'jornalista' || usuarioAtual.cargo === 'dono') {
                        mostrarPainel();
                    } else {
                        mostrarHome();
                    }
                })
                .catch(error => {
                    mostrarMensagem('erro', 'Erro ao publicar not√≠cia: ' + error.message);
                });
        }

        function editarNoticia(id) {
            const noticia = noticias.find(n => n.id === id);
            if (!noticia) return;

            if (usuarioAtual.cargo !== 'dono' && noticia.autorId !== usuarioAtual.id) {
                mostrarMensagem('erro', 'Voc√™ s√≥ pode editar suas pr√≥prias not√≠cias!');
                return;
            }

            const overlay = document.getElementById('modal-overlay');
            overlay.innerHTML = `
                <div class="modal">
                    <div class="modal-header">
                        <h3>Editar Not√≠cia</h3>
                        <button class="modal-close" onclick="fecharModal()">&times;</button>
                    </div>
                    <div class="modal-body">
                        <div class="campo-form">
                            <label>T√≠tulo:</label>
                            <input type="text" id="editar-titulo" value="${noticia.titulo}">
                        </div>
                        <div class="campo-form">
                            <label>Subt√≠tulo:</label>
                            <input type="text" id="editar-subtitulo" value="${noticia.subtitulo}">
                        </div>
                        <div class="campo-form">
                            <label>Categoria:</label>
                            <select id="editar-categoria">
                                <option value="Pol√≠tica" ${noticia.categoria === 'Pol√≠tica' ? 'selected' : ''}>Pol√≠tica</option>
                                <option value="Pol√≠cia" ${noticia.categoria === 'Pol√≠cia' ? 'selected' : ''}>Pol√≠cia</option>
                                <option value="Educa√ß√£o" ${noticia.categoria === 'Educa√ß√£o' ? 'selected' : ''}>Educa√ß√£o</option>
                                <option value="Esporte" ${noticia.categoria === 'Esporte' ? 'selected' : ''}>Esporte</option>
                                <option value="Entretenimento" ${noticia.categoria === 'Entretenimento' ? 'selected' : ''}>Entretenimento</option>
                                <option value="Curiosidades" ${noticia.categoria === 'Curiosidades' ? 'selected' : ''}>Curiosidades</option>
                            </select>
                        </div>
                        <div class="campo-form">
                            <label>Conte√∫do:</label>
                            <textarea id="editar-conteudo" rows="10">${noticia.conteudo}</textarea>
                        </div>
                        <div class="campo-form">
                            <label>Tags (separadas por v√≠rgula):</label>
                            <input type="text" id="editar-tags" value="${noticia.tags || ''}">
                        </div>
                        <div class="campo-form">
                            <label>Alterar Imagem:</label>
                            <input type="file" id="editar-imagem" accept="image/*">
                            <small>Deixe em branco para manter a imagem atual</small>
                        </div>
                        <button class="btn" onclick="salvarEdicaoNoticia('${id}')">Salvar Altera√ß√µes</button>
                    </div>
                </div>
            `;
            overlay.classList.add('active');
        }

        function salvarEdicaoNoticia(id) {
            const titulo = document.getElementById('editar-titulo').value;
            const subtitulo = document.getElementById('editar-subtitulo').value;
            const categoria = document.getElementById('editar-categoria').value;
            const conteudo = document.getElementById('editar-conteudo').value;
            const tags = document.getElementById('editar-tags').value;
            const imagemInput = document.getElementById('editar-imagem');

            const atualizacoes = {
                titulo,
                subtitulo,
                categoria,
                conteudo,
                tags
            };

            // Processar nova imagem se houver
            if (imagemInput.files.length > 0) {
                const file = imagemInput.files[0];
                const reader = new FileReader();
                
                reader.onload = function(event) {
                    atualizacoes.imagemBase64 = event.target.result;
                    salvarNoticiaNoBanco(id, atualizacoes);
                };
                
                reader.readAsDataURL(file);
            } else {
                salvarNoticiaNoBanco(id, atualizacoes);
            }
        }

        function salvarNoticiaNoBanco(id, atualizacoes) {
            database.ref(`noticias/${id}`).update(atualizacoes)
                .then(() => {
                    fecharModal();
                    mostrarMensagem('sucesso', 'Not√≠cia atualizada com sucesso!');
                    mostrarNoticia(id);
                })
                .catch(error => {
                    mostrarMensagem('erro', 'Erro ao atualizar not√≠cia: ' + error.message);
                });
        }

        function excluirNoticia(id) {
            if (!confirm('Tem certeza que deseja excluir esta not√≠cia? Esta a√ß√£o n√£o pode ser desfeita.')) return;

            const noticia = noticias.find(n => n.id === id);
            if (usuarioAtual.cargo !== 'dono' && noticia.autorId !== usuarioAtual.id) {
                mostrarMensagem('erro', 'Voc√™ s√≥ pode excluir suas pr√≥prias not√≠cias!');
                return;
            }

            database.ref(`noticias/${id}`).remove()
                .then(() => {
                    // Excluir coment√°rios tamb√©m
                    database.ref(`comentarios/${id}`).remove();
                    
                    mostrarMensagem('sucesso', 'Not√≠cia exclu√≠da com sucesso!');
                    
                    if (usuarioAtual.cargo === 'jornalista' || usuarioAtual.cargo === 'dono') {
                        mostrarPainel();
                    } else {
                        mostrarHome();
                    }
                });
        }

        // ============================================
        // FUN√á√ïES DO DONO
        // ============================================
        function alterarCargo(idUsuario, novoCargo) {
            database.ref(`usuarios/${idUsuario}/cargo`).set(novoCargo)
                .then(() => {
                    mostrarMensagem('sucesso', 'Cargo alterado com sucesso!');
                });
        }

        function excluirUsuario(idUsuario) {
            if (!confirm('Tem certeza que deseja excluir este usu√°rio? Esta a√ß√£o n√£o pode ser desfeita.')) return;

            database.ref(`usuarios/${idUsuario}`).remove()
                .then(() => {
                    mostrarMensagem('sucesso', 'Usu√°rio exclu√≠do com sucesso!');
                    mostrarPainel();
                });
        }

        function verHistorico() {
            const overlay = document.getElementById('modal-overlay');
            overlay.innerHTML = `
                <div class="modal">
                    <div class="modal-header">
                        <h3>Hist√≥rico de A√ß√µes</h3>
                        <button class="modal-close" onclick="fecharModal()">&times;</button>
                    </div>
                    <div class="modal-body">
                        <div style="text-align: center; padding: 40px; color: var(--cinza-escuro);">
                            <i class="fas fa-history" style="font-size: 3rem; margin-bottom: 20px;"></i>
                            <h3>Hist√≥rico em desenvolvimento</h3>
                            <p>Esta funcionalidade ser√° implementada na pr√≥xima vers√£o.</p>
                        </div>
                    </div>
                </div>
            `;
            overlay.classList.add('active');
        }

        // ============================================
        // FUN√á√ïES ADICIONAIS
        // ============================================
        function mostrarEstatisticas() {
            const totalNoticias = noticias.length;
            const totalComentarios = Object.values(noticias).reduce((total, noticia) => {
                return total + (noticia.comentarios ? Object.keys(noticia.comentarios).length : 0);
            }, 0);
            
            const totalCurtidas = noticias.reduce((total, noticia) => total + (noticia.curtidas || 0), 0);
            const totalRepublicacoes = noticias.reduce((total, noticia) => total + (noticia.republicacoes || 0), 0);

            // Buscar total de usu√°rios
            database.ref('usuarios').once('value')
                .then(snapshot => {
                    const totalUsuarios = snapshot.val() ? Object.keys(snapshot.val()).length : 0;

                    const main = document.getElementById('main-container');
                    main.innerHTML = `
                        <div class="secao" style="grid-column: 1 / -1;">
                            <button class="btn btn-secondary" onclick="mostrarHome()">‚Üê Voltar para Home</button>
                            <h1 style="margin-top: 30px;">üìä Estat√≠sticas do Site</h1>
                            
                            <div class="estatisticas-grid">
                                <div class="estatistica-card">
                                    <div class="estatistica-numero">${totalNoticias}</div>
                                    <div class="estatistica-label">Not√≠cias Publicadas</div>
                                </div>
                                <div class="estatistica-card">
                                    <div class="estatistica-numero">${totalUsuarios}</div>
                                    <div class="estatistica-label">Usu√°rios Cadastrados</div>
                                </div>
                                <div class="estatistica-card">
                                    <div class="estatistica-numero">${totalComentarios}</div>
                                    <div class="estatistica-label">Coment√°rios</div>
                                </div>
                                <div class="estatistica-card">
                                    <div class="estatistica-numero">${totalCurtidas}</div>
                                    <div class="estatistica-label">Curtidas</div>
                                </div>
                                <div class="estatistica-card">
                                    <div class="estatistica-numero">${totalRepublicacoes}</div>
                                    <div class="estatistica-label">Republica√ß√µes</div>
                                </div>
                                <div class="estatistica-card">
                                    <div class="estatistica-numero">${Object.values(visualizacoes).reduce((a, b) => a + b, 0)}</div>
                                    <div class="estatistica-label">Visualiza√ß√µes</div>
                                </div>
                            </div>

                            <div style="margin-top: 40px;">
                                <h2>Distribui√ß√£o por Categoria</h2>
                                <div style="background: var(--cinza-claro); padding: 20px; border-radius: 10px; margin-top: 20px;">
                                    ${['Pol√≠tica', 'Pol√≠cia', 'Educa√ß√£o', 'Esporte', 'Entretenimento', 'Curiosidades'].map(categoria => {
                                        const quantidade = noticias.filter(n => n.categoria === categoria).length;
                                        const porcentagem = totalNoticias > 0 ? ((quantidade / totalNoticias) * 100).toFixed(1) : 0;
                                        
                                        return `
                                            <div style="margin-bottom: 15px;">
                                                <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                                                    <span>${categoria}</span>
                                                    <span>${quantidade} (${porcentagem}%)</span>
                                                </div>
                                                <div style="height: 10px; background: var(--cinza-medio); border-radius: 5px; overflow: hidden;">
                                                    <div style="height: 100%; background: var(--vermelho-g1); width: ${porcentagem}%;"></div>
                                                </div>
                                            </div>
                                        `;
                                    }).join('')}
                                </div>
                            </div>
                        </div>
                    `;
                });
        }

        function mostrarFavoritos() {
            if (!usuarioAtual) {
                mostrarLogin();
                return;
            }

            const noticiasFavoritas = noticias.filter(n => favoritos.includes(n.id));

            const main = document.getElementById('main-container');
            main.innerHTML = `
                <div class="secao" style="grid-column: 1 / -1;">
                    <button class="btn btn-secondary" onclick="mostrarHome()">‚Üê Voltar para Home</button>
                    <h1 style="margin-top: 30px;">‚≠ê Not√≠cias Favoritas</h1>
                    
                    ${noticiasFavoritas.length > 0 ? `
                        <div class="lista-noticias">
                            ${noticiasFavoritas.map(noticia => `
                                <div class="card-noticia" onclick="mostrarNoticia('${noticia.id}')">
                                    <div class="card-imagem-container">
                                        ${noticia.imagemBase64 ? 
                                            `<img src="${noticia.imagemBase64}" alt="${noticia.titulo}" class="card-imagem">` :
                                            `<div class="skeleton" style="height: 100%;"></div>`
                                        }
                                    </div>
                                    <div class="card-conteudo">
                                        <div class="card-categoria">${noticia.categoria}</div>
                                        <h3 class="card-titulo">${noticia.titulo}</h3>
                                        <p>${noticia.subtitulo.substring(0, 100)}...</p>
                                        <div class="card-meta">
                                            <span>${formatarData(noticia.data)}</span>
                                            <button class="acao-btn favoritado" onclick="event.stopPropagation(); favoritarNoticia('${noticia.id}')">
                                                <i class="fas fa-star"></i>
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                    ` : `
                        <div style="text-align: center; padding: 50px; background: var(--cinza-claro); border-radius: 10px; margin-top: 30px;">
                            <i class="fas fa-star" style="font-size: 3rem; color: var(--cinza-escuro); margin-bottom: 20px;"></i>
                            <h3>Nenhuma not√≠cia favoritada</h3>
                            <p style="margin: 20px 0;">Voc√™ ainda n√£o favoritou nenhuma not√≠cia.</p>
                            <button class="btn" onclick="mostrarHome()">Explorar Not√≠cias</button>
                        </div>
                    `}
                </div>
            `;
        }

        function filtrarPorCategoria(categoria) {
            const noticiasFiltradas = noticias.filter(n => n.categoria === categoria);
            
            const main = document.getElementById('main-container');
            main.innerHTML = `
                <div class="secao" style="grid-column: 1 / -1;">
                    <button class="btn btn-secondary" onclick="mostrarHome()">‚Üê Voltar para Home</button>
                    <h1 style="margin-top: 30px;">Not√≠cias de ${categoria}</h1>
                    
                    ${noticiasFiltradas.length > 0 ? `
                        <div class="lista-noticias">
                            ${noticiasFiltradas.map(noticia => `
                                <div class="card-noticia" onclick="mostrarNoticia('${noticia.id}')">
                                    <div class="card-imagem-container">
                                        ${noticia.imagemBase64 ? 
                                            `<img src="${noticia.imagemBase64}" alt="${noticia.titulo}" class="card-imagem">` :
                                            `<div class="skeleton" style="height: 100%;"></div>`
                                        }
                                    </div>
                                    <div class="card-conteudo">
                                        <div class="card-categoria">${noticia.categoria}</div>
                                        <h3 class="card-titulo">${noticia.titulo}</h3>
                                        <p>${noticia.subtitulo.substring(0, 100)}...</p>
                                        <div class="card-meta">
                                            <span>${formatarData(noticia.data)}</span>
                                        </div>
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                    ` : `
                        <div style="text-align: center; padding: 50px; background: var(--cinza-claro); border-radius: 10px; margin-top: 30px;">
                            <h3>Nenhuma not√≠cia encontrada</h3>
                            <p style="margin: 20px 0;">N√£o h√° not√≠cias na categoria ${categoria}.</p>
                            <button class="btn" onclick="mostrarHome()">Voltar para Home</button>
                        </div>
                    `}
                </div>
            `;
        }

        function aplicarFiltros() {
            const categoria = document.getElementById('filtro-categoria').value;
            const data = document.getElementById('filtro-data').value;
            
            let noticiasFiltradas = noticias;
            
            // Filtrar por categoria
            if (categoria) {
                noticiasFiltradas = noticiasFiltradas.filter(n => n.categoria === categoria);
            }
            
            // Filtrar por data
            if (data) {
                const hoje = new Date();
                const umaSemanaAtras = new Date(hoje.getTime() - 7 * 24 * 60 * 60 * 1000);
                const umMesAtras = new Date(hoje.getTime() - 30 * 24 * 60 * 60 * 1000);
                
                noticiasFiltradas = noticiasFiltradas.filter(n => {
                    const dataNoticia = new Date(n.data);
                    
                    switch(data) {
                        case 'hoje':
                            return dataNoticia.toDateString() === hoje.toDateString();
                        case 'semana':
                            return dataNoticia >= umaSemanaAtras;
                        case 'mes':
                            return dataNoticia >= umMesAtras;
                        default:
                            return true;
                    }
                });
            }
            
            // Mostrar resultados
            const main = document.getElementById('main-container');
            main.innerHTML = `
                <div class="secao" style="grid-column: 1 / -1;">
                    <button class="btn btn-secondary" onclick="mostrarHome()">‚Üê Voltar para Home</button>
                    <h1 style="margin-top: 30px;">Resultados da Busca</h1>
                    <p>${categoria ? `Categoria: ${categoria} ‚Ä¢ ` : ''}${data ? `Per√≠odo: ${data} ‚Ä¢ ` : ''}${noticiasFiltradas.length} resultados encontrados</p>
                    
                    ${noticiasFiltradas.length > 0 ? `
                        <div class="lista-noticias">
                            ${noticiasFiltradas.map(noticia => `
                                <div class="card-noticia" onclick="mostrarNoticia('${noticia.id}')">
                                    <div class="card-imagem-container">
                                        ${noticia.imagemBase64 ? 
                                            `<img src="${noticia.imagemBase64}" alt="${noticia.titulo}" class="card-imagem">` :
                                            `<div class="skeleton" style="height: 100%;"></div>`
                                        }
                                    </div>
                                    <div class="card-conteudo">
                                        <div class="card-categoria">${noticia.categoria}</div>
                                        <h3 class="card-titulo">${noticia.titulo}</h3>
                                        <p>${noticia.subtitulo.substring(0, 100)}...</p>
                                        <div class="card-meta">
                                            <span>${formatarData(noticia.data)}</span>
                                        </div>
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                    ` : `
                        <div style="text-align: center; padding: 50px; background: var(--cinza-claro); border-radius: 10px; margin-top: 30px;">
                            <h3>Nenhuma not√≠cia encontrada</h3>
                            <p style="margin: 20px 0;">Tente ajustar os filtros da busca.</p>
                            <button class="btn" onclick="mostrarHome()">Voltar para Home</button>
                        </div>
                    `}
                </div>
            `;
        }

        // ============================================
        // FUN√á√ïES DE NOTIFICA√á√ïES
        // ============================================
        function criarNotificacao(usuarioId, tipo, noticiaId, nomeUsuario) {
            if (!usuarioId) return;

            const notificacao = {
                tipo,
                noticiaId,
                nomeUsuario,
                data: new Date().toISOString(),
                lida: false
            };

            database.ref(`notificacoes/${usuarioId}`).push(notificacao);
        }

        function carregarNotificacoes() {
            if (!usuarioAtual) return;

            database.ref(`notificacoes/${usuarioAtual.id}`).on('value', snapshot => {
                notificacoes = [];
                const dados = snapshot.val() || {};
                
                for (const id in dados) {
                    notificacoes.push({
                        id,
                        ...dados[id]
                    });
                }
                
                // Ordenar por data (mais recente primeiro)
                notificacoes.sort((a, b) => new Date(b.data) - new Date(a.data));
                
                atualizarInterfaceNotificacoes();
            });
        }

        function atualizarInterfaceNotificacoes() {
            const lista = document.getElementById('notificacoes-lista');
            const contador = document.getElementById('contador-notificacoes');
            
            if (!lista || !contador) return;
            
            // Filtrar notifica√ß√µes n√£o lidas
            const naoLidas = notificacoes.filter(n => !n.lida);
            
            // Atualizar contador
            if (naoLidas.length > 0) {
                contador.textContent = naoLidas.length;
                contador.style.display = 'inline-block';
            } else {
                contador.style.display = 'none';
            }
            
            // Atualizar lista
            lista.innerHTML = notificacoes.map(notificacao => {
                let texto = '';
                let icone = '';
                
                switch(notificacao.tipo) {
                    case 'curtida':
                        texto = `${notificacao.nomeUsuario} curtiu sua not√≠cia`;
                        icone = 'üëç';
                        break;
                    case 'comentario':
                        texto = `${notificacao.nomeUsuario} comentou na sua not√≠cia`;
                        icone = 'üí¨';
                        break;
                    case 'republicacao':
                        texto = `${notificacao.nomeUsuario} republicou sua not√≠cia`;
                        icone = 'üîÅ';
                        break;
                    default:
                        texto = 'Nova notifica√ß√£o';
                        icone = 'üîî';
                }
                
                return `
                    <div class="notificacao ${notificacao.lida ? '' : 'notificacao-nao-lida'}" 
                         onclick="abrirNotificacao('${notificacao.id}', '${notificacao.noticiaId}')">
                        <div style="font-weight: bold; margin-bottom: 5px;">${icone} ${texto}</div>
                        <div style="font-size: 0.8rem; color: var(--cinza-escuro);">
                            ${formatarData(notificacao.data)}
                        </div>
                    </div>
                `;
            }).join('') || '<div style="padding: 20px; text-align: center;">Nenhuma notifica√ß√£o</div>';
        }

        function abrirNotificacao(idNotificacao, idNoticia) {
            // Marcar como lida
            database.ref(`notificacoes/${usuarioAtual.id}/${idNotificacao}/lida`).set(true);
            
            // Abrir a not√≠cia
            mostrarNoticia(idNoticia);
            toggleNotificacoes();
        }

        // ============================================
        // FUN√á√ïES DE UTILIDADE DO MODAL
        // ============================================
        function fecharModal() {
            document.getElementById('modal-overlay').classList.remove('active');
        }

        function carregarFavoritos() {
            if (!usuarioAtual) return;
            
            const favoritosSalvos = localStorage.getItem(`favoritos_${usuarioAtual.id}`);
            if (favoritosSalvos) {
                favoritos = JSON.parse(favoritosSalvos);
            }
        }

        // ============================================
        // INICIALIZA√á√ÉO
        // ============================================
        document.addEventListener('DOMContentLoaded', function() {
            // Atualizar hora a cada minuto
            atualizarHora();
            setInterval(atualizarHora, 60000);
            
            // Carregar not√≠cias
            carregarNoticias();
            
            // Mostrar home inicialmente
            mostrarHome();
            
            // Fechar modal ao clicar fora
            document.getElementById('modal-overlay').addEventListener('click', function(e) {
                if (e.target === this) {
                    fecharModal();
                }
            });
            
            // Fechar menu mobile ao clicar fora (para mobile)
            document.addEventListener('click', function(e) {
                const menu = document.getElementById('menu-mobile');
                const hamburguer = document.querySelector('.menu-hamburguer');
                
                if (menu.classList.contains('active') && 
                    !menu.contains(e.target) && 
                    !hamburguer.contains(e.target)) {
                    menu.classList.remove('active');
                }
            });
        });
    </script>
</body>
</html>
